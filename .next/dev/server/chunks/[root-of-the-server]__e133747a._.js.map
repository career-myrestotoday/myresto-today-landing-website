{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hafiz/OneDrive/Documents/myResto%20Today/myresto-today-landing-website/lib/mysql.ts"],"sourcesContent":["import mysql from 'mysql2/promise'\r\n\r\nconst {\r\n  MYSQL_HOST = '',\r\n  MYSQL_USER = '',\r\n  MYSQL_PASSWORD = '',\r\n  MYSQL_DATABASE = '',\r\n  MYSQL_PORT = '3306',\r\n} = process.env\r\n\r\nlet pool: mysql.Pool | null = null\r\n\r\nexport function getPool() {\r\n  if (pool) return pool\r\n  if (!MYSQL_HOST || !MYSQL_USER || !MYSQL_DATABASE) {\r\n    throw new Error('MySQL environment variables not set (MYSQL_HOST, MYSQL_USER, MYSQL_DATABASE)')\r\n  }\r\n\r\n  pool = mysql.createPool({\r\n    host: MYSQL_HOST,\r\n    user: MYSQL_USER,\r\n    password: MYSQL_PASSWORD,\r\n    database: MYSQL_DATABASE,\r\n    port: Number(MYSQL_PORT),\r\n    waitForConnections: true,\r\n    connectionLimit: 10,\r\n    queueLimit: 0,\r\n  })\r\n\r\n  return pool\r\n}\r\n\r\nexport async function ensureTables() {\r\n  const p = getPool()\r\n  // posts table\r\n  await p.query(`\r\n    CREATE TABLE IF NOT EXISTS posts (\r\n      id INT PRIMARY KEY AUTO_INCREMENT,\r\n      title VARCHAR(255) NOT NULL,\r\n      slug VARCHAR(255) NOT NULL UNIQUE,\r\n      content TEXT,\r\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\r\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\r\n  `)\r\n\r\n  // visitors table (single row stores count)\r\n  await p.query(`\r\n    CREATE TABLE IF NOT EXISTS visitors (\r\n      id INT PRIMARY KEY AUTO_INCREMENT,\r\n      count BIGINT DEFAULT 0,\r\n      updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\r\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\r\n  `)\r\n\r\n  // ensure at least one row in visitors\r\n  const [rows]: any = await p.query('SELECT COUNT(*) as c FROM visitors')\r\n  if (rows && rows[0] && rows[0].c === 0) {\r\n    await p.query('INSERT INTO visitors (count) VALUES (0)')\r\n  }\r\n}\r\n\r\nexport async function incrementVisitor() {\r\n  const p = getPool()\r\n  await ensureTables()\r\n  await p.query('UPDATE visitors SET count = count + 1')\r\n  const [rows]: any = await p.query('SELECT count FROM visitors LIMIT 1')\r\n  return rows && rows[0] ? Number(rows[0].count) : 0\r\n}\r\n\r\nexport async function getVisitorCount() {\r\n  const p = getPool()\r\n  await ensureTables()\r\n  const [rows]: any = await p.query('SELECT count FROM visitors LIMIT 1')\r\n  return rows && rows[0] ? Number(rows[0].count) : 0\r\n}\r\n\r\nexport async function listPosts() {\r\n  const p = getPool()\r\n  await ensureTables()\r\n  const [rows]: any = await p.query('SELECT id,title,slug,content,created_at FROM posts ORDER BY created_at DESC')\r\n  return rows\r\n}\r\n\r\nexport async function createPost({ title, slug, content }: { title: string; slug: string; content?: string }) {\r\n  const p = getPool()\r\n  await ensureTables()\r\n  const [res]: any = await p.query('INSERT INTO posts (title,slug,content) VALUES (?,?,?)', [title, slug, content || null])\r\n  return res.insertId\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAEA,MAAM,EACJ,aAAa,EAAE,EACf,aAAa,EAAE,EACf,iBAAiB,EAAE,EACnB,iBAAiB,EAAE,EACnB,aAAa,MAAM,EACpB,GAAG,QAAQ,GAAG;AAEf,IAAI,OAA0B;AAEvB,SAAS;IACd,IAAI,MAAM,OAAO;IACjB,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,gBAAgB;QACjD,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,MAAM,UAAU,CAAC;QACtB,MAAM;QACN,MAAM;QACN,UAAU;QACV,UAAU;QACV,MAAM,OAAO;QACb,oBAAoB;QACpB,iBAAiB;QACjB,YAAY;IACd;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,IAAI;IACV,cAAc;IACd,MAAM,EAAE,KAAK,CAAC,CAAC;;;;;;;;EAQf,CAAC;IAED,2CAA2C;IAC3C,MAAM,EAAE,KAAK,CAAC,CAAC;;;;;;EAMf,CAAC;IAED,sCAAsC;IACtC,MAAM,CAAC,KAAK,GAAQ,MAAM,EAAE,KAAK,CAAC;IAClC,IAAI,QAAQ,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,GAAG;QACtC,MAAM,EAAE,KAAK,CAAC;IAChB;AACF;AAEO,eAAe;IACpB,MAAM,IAAI;IACV,MAAM;IACN,MAAM,EAAE,KAAK,CAAC;IACd,MAAM,CAAC,KAAK,GAAQ,MAAM,EAAE,KAAK,CAAC;IAClC,OAAO,QAAQ,IAAI,CAAC,EAAE,GAAG,OAAO,IAAI,CAAC,EAAE,CAAC,KAAK,IAAI;AACnD;AAEO,eAAe;IACpB,MAAM,IAAI;IACV,MAAM;IACN,MAAM,CAAC,KAAK,GAAQ,MAAM,EAAE,KAAK,CAAC;IAClC,OAAO,QAAQ,IAAI,CAAC,EAAE,GAAG,OAAO,IAAI,CAAC,EAAE,CAAC,KAAK,IAAI;AACnD;AAEO,eAAe;IACpB,MAAM,IAAI;IACV,MAAM;IACN,MAAM,CAAC,KAAK,GAAQ,MAAM,EAAE,KAAK,CAAC;IAClC,OAAO;AACT;AAEO,eAAe,WAAW,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAqD;IAC1G,MAAM,IAAI;IACV,MAAM;IACN,MAAM,CAAC,IAAI,GAAQ,MAAM,EAAE,KAAK,CAAC,yDAAyD;QAAC;QAAO;QAAM,WAAW;KAAK;IACxH,OAAO,IAAI,QAAQ;AACrB"}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hafiz/OneDrive/Documents/myResto%20Today/myresto-today-landing-website/app/api/track/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { incrementVisitor } from '@/lib/mysql'\r\n\r\nexport async function POST() {\r\n  try {\r\n    const count = await incrementVisitor()\r\n    return NextResponse.json({ ok: true, count })\r\n  } catch (err: any) {\r\n    console.error('track error', err.message)\r\n    return NextResponse.json({ ok: false, error: err.message }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,QAAQ,MAAM,IAAA,uNAAgB;QACpC,OAAO,qOAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM;QAAM;IAC7C,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,eAAe,IAAI,OAAO;QACxC,OAAO,qOAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO,OAAO,IAAI,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF"}}]
}